/*
 * Registered custom property for font-size values
 * 
 * This @property declaration registers --eds-typography-font-size as a typed CSS custom property,
 * enabling proper unit handling in calc() expressions. This is essential for the
 * text-icon sizing calculations, which use tan(atan2(var(--eds-typography-font-size), 1px)) to
 * extract the numeric value from the font-size for proportional icon scaling.
 * 
 * Without this registration, the browser would treat --eds-typography-font-size as an untyped string,
 * preventing the mathematical operations needed for responsive icon sizing based on
 * the current text size.
 */
@property --eds-typography-font-size {
  inherits: true;
  initial-value: 16px;
  syntax: '<length>';
}

/* Reset typography margin and set display mode */
[data-font-family] {
  margin: 0;
  /* 
   * Block display required for text-box trimming and baseline grid alignment.
   */
  display: block;
  font-size: var(--eds-typography-font-size);
  font-family: var(--eds-typography-font-family);
  font-weight: var(--eds-typography-font-weight);
  line-height: var(--eds-typography-line-height);
  letter-spacing: var(--eds-typography-tracking);
}

/* Font family setup */
[data-font-family='ui'] {
  --eds-typography-font-family:
    var(--eds-typography-ui-body-font-family), sans-serif;
}

[data-font-family='header'] {
  --eds-typography-font-family:
    var(--eds-typography-header-font-family), sans-serif;
}

[data-font-family='ui'] {
  &[data-text-size='xs'] {
    --_font-size-xs: var(--eds-typography-ui-body-xs-font-size);
    --_line-height-default: var(--eds-typography-ui-body-xs-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-ui-body-xs-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-xs-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-xs-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-xs-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-xs-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-xs-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-xs-tracking-wide);
  }

  &[data-text-size='sm'] {
    --_font-size-sm: var(--eds-typography-ui-body-sm-font-size);
    --_line-height-default: var(--eds-typography-ui-body-sm-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-ui-body-sm-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-sm-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-sm-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-sm-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-sm-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-sm-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-sm-tracking-wide);
  }

  &[data-text-size='md'] {
    --_font-size-md: var(--eds-typography-ui-body-md-font-size);
    --_line-height-default: var(--eds-typography-ui-body-md-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-ui-body-md-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-md-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-md-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-md-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-md-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-md-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-md-tracking-wide);
  }

  &[data-text-size='lg'] {
    --_font-size-lg: var(--eds-typography-ui-body-lg-font-size);
    --_line-height-default: var(--eds-typography-ui-body-lg-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-ui-body-lg-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-lg-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-lg-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-lg-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-lg-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-lg-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-lg-tracking-wide);
  }

  &[data-text-size='xl'] {
    --_font-size-xl: var(--eds-typography-ui-body-xl-font-size);
    --_line-height-default: var(--eds-typography-ui-body-xl-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-ui-body-xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-xl-tracking-wide);
  }

  &[data-text-size='2xl'] {
    --_font-size-2xl: var(--eds-typography-ui-body-2xl-font-size);
    --_line-height-default: var(
      --eds-typography-ui-body-2xl-lineheight-default
    );
    --_line-height-squished: var(
      --eds-typography-ui-body-2xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-2xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-2xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-2xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-2xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-2xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-2xl-tracking-wide);
  }

  &[data-text-size='3xl'] {
    --_font-size-3xl: var(--eds-typography-ui-body-3xl-font-size);
    --_line-height-default: var(
      --eds-typography-ui-body-3xl-lineheight-default
    );
    --_line-height-squished: var(
      --eds-typography-ui-body-3xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-3xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-3xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-3xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-3xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-3xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-3xl-tracking-wide);
  }

  &[data-text-size='4xl'] {
    --_font-size-4xl: var(--eds-typography-ui-body-4xl-font-size);
    --_line-height-default: var(
      --eds-typography-ui-body-4xl-lineheight-default
    );
    --_line-height-squished: var(
      --eds-typography-ui-body-4xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-4xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-4xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-4xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-4xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-4xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-4xl-tracking-wide);
  }

  &[data-text-size='5xl'] {
    --_font-size-5xl: var(--eds-typography-ui-body-5xl-font-size);
    --_line-height-default: var(
      --eds-typography-ui-body-5xl-lineheight-default
    );
    --_line-height-squished: var(
      --eds-typography-ui-body-5xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-5xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-5xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-5xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-5xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-5xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-5xl-tracking-wide);
  }

  &[data-text-size='6xl'] {
    --_font-size-6xl: var(--eds-typography-ui-body-6xl-font-size);
    --_line-height-default: var(
      --eds-typography-ui-body-6xl-lineheight-default
    );
    --_line-height-squished: var(
      --eds-typography-ui-body-6xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-ui-body-6xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-ui-body-6xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-ui-body-6xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-ui-body-6xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-ui-body-6xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-ui-body-6xl-tracking-wide);
  }
}

[data-font-family='header'] {
  &[data-text-size='xs'] {
    --_font-size-xs: var(--eds-typography-header-xs-font-size);
    --_line-height-default: var(--eds-typography-header-xs-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-xs-lineheight-squished
    );
    --_font-weight-lighter: var(--eds-typography-header-xs-font-weight-lighter);
    --_font-weight-normal: var(--eds-typography-header-xs-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-xs-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-xs-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-xs-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-xs-tracking-wide);
  }

  &[data-text-size='sm'] {
    --_font-size-sm: var(--eds-typography-header-sm-font-size);
    --_line-height-default: var(--eds-typography-header-sm-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-sm-lineheight-squished
    );
    --_font-weight-lighter: var(--eds-typography-header-sm-font-weight-lighter);
    --_font-weight-normal: var(--eds-typography-header-sm-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-sm-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-sm-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-sm-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-sm-tracking-wide);
  }

  &[data-text-size='md'] {
    --_font-size-md: var(--eds-typography-header-md-font-size);
    --_line-height-default: var(--eds-typography-header-md-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-md-lineheight-squished
    );
    --_font-weight-lighter: var(--eds-typography-header-md-font-weight-lighter);
    --_font-weight-normal: var(--eds-typography-header-md-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-md-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-md-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-md-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-md-tracking-wide);
  }

  &[data-text-size='lg'] {
    --_font-size-lg: var(--eds-typography-header-lg-font-size);
    --_line-height-default: var(--eds-typography-header-lg-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-lg-lineheight-squished
    );
    --_font-weight-lighter: var(--eds-typography-header-lg-font-weight-lighter);
    --_font-weight-normal: var(--eds-typography-header-lg-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-lg-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-lg-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-lg-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-lg-tracking-wide);
  }

  &[data-text-size='xl'] {
    --_font-size-xl: var(--eds-typography-header-xl-font-size);
    --_line-height-default: var(--eds-typography-header-xl-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-xl-lineheight-squished
    );
    --_font-weight-lighter: var(--eds-typography-header-xl-font-weight-lighter);
    --_font-weight-normal: var(--eds-typography-header-xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-xl-tracking-wide);
  }

  &[data-text-size='2xl'] {
    --_font-size-2xl: var(--eds-typography-header-2xl-font-size);
    --_line-height-default: var(--eds-typography-header-2xl-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-2xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-header-2xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-header-2xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-2xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-2xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-2xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-2xl-tracking-wide);
  }

  &[data-text-size='3xl'] {
    --_font-size-3xl: var(--eds-typography-header-3xl-font-size);
    --_line-height-default: var(--eds-typography-header-3xl-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-3xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-header-3xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-header-3xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-3xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-3xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-3xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-3xl-tracking-wide);
  }

  &[data-text-size='4xl'] {
    --_font-size-4xl: var(--eds-typography-header-4xl-font-size);
    --_line-height-default: var(--eds-typography-header-4xl-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-4xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-header-4xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-header-4xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-4xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-4xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-4xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-4xl-tracking-wide);
  }

  &[data-text-size='5xl'] {
    --_font-size-5xl: var(--eds-typography-header-5xl-font-size);
    --_line-height-default: var(--eds-typography-header-5xl-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-5xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-header-5xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-header-5xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-5xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-5xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-5xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-5xl-tracking-wide);
  }

  &[data-text-size='6xl'] {
    --_font-size-6xl: var(--eds-typography-header-6xl-font-size);
    --_line-height-default: var(--eds-typography-header-6xl-lineheight-default);
    --_line-height-squished: var(
      --eds-typography-header-6xl-lineheight-squished
    );
    --_font-weight-lighter: var(
      --eds-typography-header-6xl-font-weight-lighter
    );
    --_font-weight-normal: var(--eds-typography-header-6xl-font-weight-normal);
    --_font-weight-bolder: var(--eds-typography-header-6xl-font-weight-bolder);
    --_tracking-tight: var(--eds-typography-header-6xl-tracking-tight);
    --_tracking-normal: var(--eds-typography-header-6xl-tracking-normal);
    --_tracking-wide: var(--eds-typography-header-6xl-tracking-wide);
  }
}

/* Shared typography styles for UI and Header font families */
[data-font-family] {
  /* Font size setup with CSS custom property */
  &[data-text-size='xs'] {
    --eds-typography-font-size: var(--_font-size-xs);
  }

  &[data-text-size='sm'] {
    --eds-typography-font-size: var(--_font-size-sm);
  }

  &[data-text-size='md'] {
    --eds-typography-font-size: var(--_font-size-md);
  }

  &[data-text-size='lg'] {
    --eds-typography-font-size: var(--_font-size-lg);
  }

  &[data-text-size='xl'] {
    --eds-typography-font-size: var(--_font-size-xl);
  }

  &[data-text-size='2xl'] {
    --eds-typography-font-size: var(--_font-size-2xl);
  }

  &[data-text-size='3xl'] {
    --eds-typography-font-size: var(--_font-size-3xl);
  }

  &[data-text-size='4xl'] {
    --eds-typography-font-size: var(--_font-size-4xl);
  }

  &[data-text-size='5xl'] {
    --eds-typography-font-size: var(--_font-size-5xl);
  }

  &[data-text-size='6xl'] {
    --eds-typography-font-size: var(--_font-size-6xl);
  }

  &[data-line-height='default'] {
    --eds-typography-line-height: var(--_line-height-default);
  }

  &[data-line-height='squished'] {
    --eds-typography-line-height: var(--_line-height-squished);
  }

  &[data-font-weight='lighter'] {
    --eds-typography-font-weight: var(--_font-weight-lighter);
  }

  &[data-font-weight='normal'] {
    --eds-typography-font-weight: var(--_font-weight-normal);
  }

  &[data-font-weight='bolder'] {
    --eds-typography-font-weight: var(--_font-weight-bolder);
  }

  &[data-tracking='tight'] {
    --eds-typography-tracking: var(--_tracking-tight);
  }

  &[data-tracking='normal'] {
    --eds-typography-tracking: var(--_tracking-normal);
  }

  &[data-tracking='wide'] {
    --eds-typography-tracking: var(--_tracking-wide);
  }
}

/* Baseline alignment - progressive enhancement with text-box-trim */
@supports (text-box: trim-both cap alphabetic) {
  [data-baseline='grid'] {
    text-box: trim-both ex alphabetic;
    /* 
     * Goal: Align text to the 4px baseline grid for consistent vertical rhythm
     * 
     * This ensures all text elements align to a consistent baseline across the page,
     * creating visual harmony and structure throughout the interface.
     * 
     * How it works:
     * - text-box: trim-both ex alphabetic removes browser's default line-height spacing
     * - padding-top: Adds calculated space to snap the baseline to the nearest 4px grid line
     * - padding-bottom: 0 keeps the bottom edge tight to the alphabetic baseline
     * - round(1cap, 4px): Rounds cap height to the nearest 4px for grid alignment
     * 
     * Result: Text baselines align to 4px intervals (0px, 4px, 8px, 12px, etc.)
     * This makes spacing between text elements predictable and visually balanced.
     */
    padding-top: calc(round(1cap, 4px) - 1ex);
    padding-bottom: 0;
  }

  [data-baseline='center'] {
    text-box: trim-both ex alphabetic;
    /* 
     * Goal: Keep the total height of the text element aligned to the 4px baseline grid
     * 
     * This padding calculation ensures that after trimming the text box, the total
     * element height (text + padding) is a multiple of 4px. This maintains visual
     * consistency with the rest of the design system's vertical rhythm.
     * 
     * How it works:
     * - round(1cap, 4px): Rounds the cap height to nearest 4px increment
     * - We adjust padding to compensate for the difference between cap and x-height
     * - Padding is distributed evenly above and below for optical centering
     * 
     * Result: Total height snaps to 4px grid (16px, 20px, 24px, etc.) while
     * maintaining centered appearance within UI elements like buttons and badges.
     */
    padding-top: calc((round(1cap, 4px) - 1ex) / 2 + (1cap - 1ex) / 2);
    padding-bottom: calc((round(1cap, 4px) - 1ex) / 2 - (1cap - 1ex) / 2);
  }
}
