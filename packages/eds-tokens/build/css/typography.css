/*
 * Registered custom property for font-size values
 * 
 * This @property declaration registers --eds-typography-font-size as a typed CSS custom property,
 * enabling proper unit handling in calc() expressions. This is essential for the
 * text-icon sizing calculations, which use tan(atan2(var(--eds-typography-font-size), 1px)) to
 * extract the numeric value from the font-size for proportional icon scaling.
 * 
 * Without this registration, the browser would treat --eds-typography-font-size as an untyped string,
 * preventing the mathematical operations needed for responsive icon sizing based on
 * the current text size.
 */
@property --eds-typography-font-size {
  inherits: true;
  initial-value: 16px;
  syntax: '<length>';
}

/* Reset typography margin and set display mode */
[data-font-family] {
  margin: 0;
  /* 
   * Block display required for text-box trimming and baseline grid alignment.
   */
  display: block;
  font-family: var(--eds-typography-font-family);
  font-size: var(--eds-typography-font-size);
  font-weight: var(--eds-typography-font-weight);
  line-height: var(--eds-typography-line-height);
  letter-spacing: var(--eds-typography-tracking);
}

/* Baseline alignment - progressive enhancement with text-box-trim */
@supports (text-box: trim-both cap alphabetic) {
  [data-baseline='grid'] {
    text-box: trim-both ex alphabetic;
    /* 
     * Goal: Align text to the 4px baseline grid for consistent vertical rhythm
     * 
     * This ensures all text elements align to a consistent baseline across the page,
     * creating visual harmony and structure throughout the interface.
     * 
     * How it works:
     * - text-box: trim-both ex alphabetic removes browser's default line-height spacing
     * - padding-top: Adds calculated space to snap the baseline to the nearest 4px grid line
     * - padding-bottom: 0 keeps the bottom edge tight to the alphabetic baseline
     * - round(1cap, 4px): Rounds cap height to the nearest 4px for grid alignment
     * 
     * Result: Text baselines align to 4px intervals (0px, 4px, 8px, 12px, etc.)
     * This makes spacing between text elements predictable and visually balanced.
     */
    padding-top: calc(round(1cap, 4px) - 1ex);
    padding-bottom: 0;
  }

  [data-baseline='center'] {
    text-box: trim-both ex alphabetic;
    /* 
     * Goal: Keep the total height of the text element aligned to the 4px baseline grid
     * 
     * This padding calculation ensures that after trimming the text box, the total
     * element height (text + padding) is a multiple of 4px. This maintains visual
     * consistency with the rest of the design system's vertical rhythm.
     * 
     * How it works:
     * - round(1cap, 4px): Rounds the cap height to nearest 4px increment
     * - We adjust padding to compensate for the difference between cap and x-height
     * - Padding is distributed evenly above and below for optical centering
     * 
     * Result: Total height snaps to 4px grid (16px, 20px, 24px, etc.) while
     * maintaining centered appearance within UI elements like buttons and badges.
     */
    padding-top: calc((round(1cap, 4px) - 1ex) / 2 + (1cap - 1ex) / 2);
    padding-bottom: calc((round(1cap, 4px) - 1ex) / 2 - (1cap - 1ex) / 2);
  }
}
