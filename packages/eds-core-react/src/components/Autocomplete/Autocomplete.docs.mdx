
import { Links, Story, PropsTable } from './../../../.storybook/components'
import * as icons from '@equinor/eds-icons'

# Autocomplete 

Allows users to choose one or multiple options from a list. The component is built using [Downshift](https://github.com/downshift-js/downshift).

<Links 
    sourceUrl="https://github.com/equinor/design-system/blob/develop/packages/eds-core-react/src/components/Autocomplete/Autocomplete.tsx"
    npmUrl="https://www.npmjs.com/package/@equinor/eds-core-react"
/>

<Story id="inputs-autocomplete--introduction" />
<PropsTable />

## Usage

The value must be chosen from a predefined list of values.

```tsx
import { Autocomplete } from '@equinor/eds-core-react'

const options = [
  'Microsoft Corporation',
   'Tesla, Inc',
   'Apple Inc.',
]

<Autocomplete 
  label="Stocks"
  options={options}
/>
```

When passing in objects as options, make sure you define the `optionLabel` function for wanted label. This function must return a string.

```tsx

const options = [
   { label: 'Microsoft Corporation', symbol: 'MSFT' },
   { label: 'Tesla, Inc', symbol: 'TSLA' },
   { label: 'Apple Inc.', symbol: 'AAPL'},
]

<Autocomplete 
  label="Stocks"
  options={options}
  optionLabel={(option) => option.label}
/>
```

## Accessibility

### ARIA
The property <code>label</code> is mandatory and makes sure you have a descriptive label for screen readers.

## Examples

### Multiple
Enable the `multiple` property for multiple selection of values.
<Story id="inputs-autocomplete--multiple" />

### Objects as options
If the options-list contains objects and not strings, you must define the `optionLabel` function to specify
how the label should be rendered and searched for. This function must return a string.

<Story id="inputs-autocomplete--option-label" />

### Controlled
Autocomplete controls its own state internally, and calls your `onOptionsChange` handler when the state changes. You can use `initialSelectedOptions`
to define pre-selected options.

If you instead want to control your own state, you can use the `selectedOptions` prop to pass your controlled data. The initial value can be an 
empty array if no elements are to be pre-selected. Use `onOptionsChange` to handle changes in selection. 

The controlled state is provided from `downshift`. You can read more about it [in the downshift documentation](https://github.com/downshift-js/downshift#control-props).

<Story id="inputs-autocomplete--controlled" />

### Read only
Use prop `readOnly`

<Story id="inputs-autocomplete--read-only" />

### Disabled
Use prop `disabled`

<Story id="inputs-autocomplete--disabled" />

### Disabled option
You can disable specific options by sending an `optionDisabled` prop containing a function that 
will disable an option if satisfied.

<Story id="inputs-autocomplete--disabled-option" />


### Preselected options
For uncontrolled components, you can use `initialSelectedOptions` to define pre-selected options.
For controlled components, you can use the `selectedOptions` prop to pass your controlled data 
(see example on this under [Controlled](?path=/docs/inputs-autocomplete--controlled)).

<Story id="inputs-autocomplete--preselected-options" />


### Compact
Compact components are toggled through the react-context [EdsProvider](?path=/docs/inputs-autocomplete--controlled).
The EdsProvider needs to encapsulate your whole application and when the context-value `density` is set `compact`,
the `Autocomplete`-component will render as compact (as well as all other EDS-components). 

Note that compact mode should come with the possibility to switch to normal mode for accessibility reasons.

<Story id="inputs-autocomplete--compact" />

### Virtualization
`Autocomplete` uses [@tanstack/react-virtual](https://tanstack.com/virtual/v3) virtualization to support large datasets.
<Story id="inputs-autocomplete--virtualized" />

### With `React Hook Form`

Example using [react-hook-form](https://react-hook-form.com/) library.
<Story id="inputs-autocomplete--with-react-hook-form" />

### Custom options filter
You can specify the filter predicate for options by setting the `optionsFilter` callback. By default the inputValue is checked against the option label. 
We stronlgy recommend always including all the characters a search might filter on in the label as it may seem confusing for users otherwise.
<Story id="inputs-autocomplete--custom-options-filter" />

### With Select All option
This is an example of how to make a "Select All" option for quicker selection. 
Make sure to use `useMemo` if you are mutating the options in the render function to avoid object memory references bugs on re-renders.
<Story id="inputs-autocomplete--select-all" />

### Option `autoWidth`
`autoWidth` set: Dropdown width is the same as input width. Otherwise, dropdown width is based on it's widest content.
The second input here also have `multiline` added to allow text wrapping.
<Story id="inputs-autocomplete--auto-width" />

### Options update
Story for testing if options are correctly update if changed after initialization.
<Story id="inputs-autocomplete--options-update" />
