@layer eds-components {
  .eds-button {
    /* Layout */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;

    /* Appearance */
    border: none;
    border-radius: var(--eds-spacing-border-radius-rounded, 4px);
    cursor: pointer;
    outline: none;
    text-decoration: none;

    /* Transitions */
    transition:
      background-color 150ms ease-in-out,
      border-color 150ms ease-in-out,
      color 150ms ease-in-out;
  }

  /* ===== SIZE VARIANTS ===== */
  /*
   * Figma uses padding + text-box-trim for content-driven button height.
   * We follow the same model with progressive enhancement:
   *
   * 1. padding-block/inline from selectable-space tokens (all browsers)
   * 2. min-height as fallback for browsers without cap unit support
   *    (half-leading makes padding alone too tall)
   * 3. @supports removes min-height — the span's cap-height constraint
   *    (see below) gives correct content-driven sizing
   *
   * Spacious (default): sm=24px, md=36px, lg=44px
   * Comfortable:        sm=20px, md=24px, lg=36px
   */

  .eds-button[data-selectable-space='lg'] {
    min-height: 2.75rem; /* 44px */
    padding-inline: var(--eds-selectable-space-horizontal);
    padding-block: var(--eds-selectable-space-vertical);
    gap: var(--eds-typography-gap-horizontal);
  }

  .eds-button[data-selectable-space='md'] {
    min-height: 2.25rem; /* 36px */
    padding-inline: var(--eds-selectable-space-horizontal);
    padding-block: var(--eds-selectable-space-vertical);
    gap: var(--eds-typography-gap-horizontal);
  }

  .eds-button[data-selectable-space='sm'] {
    min-height: 1.5rem; /* 24px */
    padding-inline: var(--eds-selectable-space-horizontal);
    padding-block: var(--eds-selectable-space-vertical);
    gap: var(--eds-typography-gap-horizontal);
  }

  /* Comfortable density */

  [data-density='comfortable'] .eds-button[data-selectable-space='lg'] {
    min-height: 2.25rem; /* 36px */
  }

  [data-density='comfortable'] .eds-button[data-selectable-space='md'] {
    min-height: 1.5rem; /* 24px */
  }

  [data-density='comfortable'] .eds-button[data-selectable-space='sm'] {
    min-height: 1.25rem; /* 20px */
  }

  /* Remove min-height when cap unit is available (Chrome 133+, Safari 17.5+).
   * Content-driven height: padding + span cap-height = exact Figma match.
   * Icon-only buttons keep min-height (they use aspect-ratio, not text). */

  @supports (text-box: trim-both cap alphabetic) {
    .eds-button[data-selectable-space]:not([data-icon-only]) {
      min-height: unset;
    }
  }

  /* ===== ICON-ONLY BUTTON ===== */
  /* Height from size variant, aspect-ratio makes it square, flexbox centers icon */

  .eds-button[data-icon-only] {
    aspect-ratio: 1;
    padding: 0;
  }

  /* ===== ROUND ICON-ONLY BUTTON ===== */

  .eds-button[data-round] {
    border-radius: 50%;
  }

  /* ===== PRIMARY VARIANT ===== */

  .eds-button[data-variant='primary'] {
    background-color: var(--eds-color-bg-fill-emphasis-default);
    color: var(--eds-color-text-strong-on-emphasis);
  }

  .eds-button[data-variant='primary']:hover:not(:disabled) {
    background-color: var(--eds-color-bg-fill-emphasis-hover);
  }

  .eds-button[data-variant='primary']:active:not(:disabled) {
    background-color: var(--eds-color-bg-fill-emphasis-active);
  }

  .eds-button[data-variant='primary']:disabled {
    background-color: var(--eds-color-bg-fill-emphasis-disabled);
    color: var(--eds-color-text-disabled);
    cursor: not-allowed;
  }

  /* ===== SECONDARY VARIANT ===== */

  .eds-button[data-variant='secondary'] {
    background-color: transparent;
    color: var(--eds-color-text-subtle);
    outline: var(--eds-border-width-default, 1px) solid
      var(--eds-color-border-strong);
    outline-offset: calc(-1 * var(--eds-border-width-default, 1px));
  }

  .eds-button[data-variant='secondary']:hover:not(:disabled) {
    background-color: var(--eds-color-bg-fill-muted-default);
  }

  .eds-button[data-variant='secondary']:active:not(:disabled) {
    background-color: var(--eds-color-bg-fill-muted-hover);
  }

  .eds-button[data-variant='secondary']:disabled {
    outline: var(--eds-border-width-default, 1px) solid
      var(--eds-color-border-disabled);
    outline-offset: calc(-1 * var(--eds-border-width-default, 1px));
    color: var(--eds-color-text-disabled);
    cursor: not-allowed;
  }

  /* ===== GHOST VARIANT ===== */

  .eds-button[data-variant='ghost'] {
    background-color: transparent;
    color: var(--eds-color-text-subtle);
  }

  .eds-button[data-variant='ghost']:hover:not(:disabled) {
    background-color: var(--eds-color-bg-fill-muted-default);
  }

  .eds-button[data-variant='ghost']:active:not(:disabled) {
    background-color: var(--eds-color-bg-fill-muted-hover);
  }

  .eds-button[data-variant='ghost']:disabled {
    color: var(--eds-color-text-disabled);
    cursor: not-allowed;
  }

  /* ===== FOCUS STATE ===== */

  .eds-button:focus-visible {
    outline: var(--eds-sizing-stroke-thick) solid
      var(--eds-color-border-focus);
    outline-offset: var(--eds-sizing-stroke-thin);
  }

  .eds-button[data-variant='secondary']:focus-visible {
    outline-offset: var(--eds-sizing-stroke-thin);
  }

  /* ===== ICON STYLING ===== */
  /* Icons inherit size from Typography via --eds-typography-icon-size */
  /* Icons use em-based negative margins from icon.css for optical alignment */

  .eds-button .icon {
    flex-shrink: 0;
  }

  /* Icon-only buttons: remove negative margins since flexbox handles centering */
  .eds-button[data-icon-only] .icon {
    margin: 0;
  }
}

/*
 * Outside @layer to override typography.css [data-font-family] { display: block }.
 * The span wraps text children via TypographyNext and needs inline-flex for
 * icon+text gap and vertical centering.
 */

.eds-button > span {
  display: inline-flex;
  align-items: center;
  gap: var(--eds-typography-gap-horizontal);
}

/*
 * Constrain span height to font cap-height so button sizing matches Figma.
 * Without this, half-leading inflates the span and padding alone gives
 * buttons 6–11px too tall.
 *
 * round(1cap, 4px) uses the span's own font metrics — it adapts per size.
 * Icons overflow the span but stay centered via align-items: center.
 * Disables typography.css baseline padding (button handles its own sizing).
 *
 */
@supports (text-box: trim-both cap alphabetic) {
  .eds-button > span {
    height: round(1cap, 4px);
    overflow: visible;
    text-box: normal;
    padding-block: 0;
  }
}

